window.Directory={Models:{},Collections:{},Views:{},Routers:{},init:function(){"use strict";console.log("Hello from Backbone!"),Directory.engineers=new Directory.Collections.Engineers,Directory.squads=new Directory.Collections.Squads,Directory.engineers.load(),Directory.squads.load(),this.applicationLayout=new Directory.Views.ApplicationLayout,this.applicationLayout.render(),$("#application-layout").replaceWith(this.applicationLayout.$el)}},this.JST=this.JST||{},this.JST=this.JST||{},this.JST["app/scripts/templates/ApplicationLayout.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<div class="engineer-list-container"></div>\n<div class="squad-list-container"></div>\n<div class="new-engineer-form-container"></div>\n'},useData:!0}),this.JST["app/scripts/templates/EngineerList.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<h1>Engineers</h1>\n<div class="engineers"></div>\n<button data-action="refresh">Refresh</button>\n'},useData:!0}),this.JST["app/scripts/templates/EngineerView.hbs"]=Handlebars.template({1:function(a,b,c,d,e){var f,g,h=null!=b?b:{};return'    <span class="label '+(null!=(f=c["if"].call(h,null!=b?b.current:b,{name:"if",hash:{},fn:a.program(2,e,0),inverse:a.program(4,e,0),data:e}))?f:"")+'">'+a.escapeExpression((g=null!=(g=c.name||(null!=b?b.name:b))?g:c.helperMissing,"function"==typeof g?g.call(h,{name:"name",hash:{},data:e}):g))+"</span>\n"},2:function(a,b,c,d,e){return"label-success"},4:function(a,b,c,d,e){return"label-default"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{};return"<h4>\n  "+a.escapeExpression((g=null!=(g=c.name||(null!=b?b.name:b))?g:c.helperMissing,"function"==typeof g?g.call(h,{name:"name",hash:{},data:e}):g))+"\n"+(null!=(f=c.each.call(h,null!=b?b.squads:b,{name:"each",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+"</h4>\n"},useData:!0}),this.JST["app/scripts/templates/NewEngineerForm.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<h2>Add New Engineer</h2>\n<div class="validation-error"></div>\n<div class="input-group">\n  <input type="text" class="form-control" name="name" value="" placeholder="Full Name">\n</div>\n<div class="input-group">\n  <input type="text" class="form-control" name="username" value="" placeholder="Username">  \n</div>\n\n<h3>Squad Memberships:</h3>\n\n<table class="squad-memberships">\n  <thead>\n    <tr>\n      <th>Squad Name</th>\n      <th>Current Member</th>\n      <th>Former Member</th>\n    </tr>\n  </thead>\n  <tbody></tbody>\n</table>\n\n<input type="submit" name="submit" value="Submit">\n'},useData:!0}),this.JST["app/scripts/templates/SquadMembershipSelector.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f;return'<td class="squad-name">'+a.escapeExpression((f=null!=(f=c.name||(null!=b?b.name:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:{},{name:"name",hash:{},data:e}):f))+'</td>\n<td><input type="checkbox" data-membership="current" value="current"></td>\n<td><input type="checkbox" data-membership="former" value="former"></td>\n'},useData:!0}),Directory.Models=Directory.Models||{},function(){"use strict";Directory.Models.Engineer=Backbone.Model.extend({url:"",initialize:function(){},defaults:function(){return{squads:new Directory.Collections.Squads}},validate:function(a,b){return!a.name||a.name.length<1?"Name is required":!a.username||a.username.length<1?"Username is required":!a.squads||a.squads.length<1?"At least one squad membership is required":void 0},parse:function(a,b){return a}})}(),Directory.Models=Directory.Models||{},function(){"use strict";Directory.Models.Squad=Backbone.Model.extend({url:"",initialize:function(){},defaults:{},validate:function(a,b){},parse:function(a,b){return a}})}(),Directory.Collections=Directory.Collections||{},function(){"use strict";Directory.Collections.Engineers=Backbone.Collection.extend({model:Directory.Models.Engineer,load:function(){var a=this;$.ajax({method:"GET",url:"/engineers",format:"json",success:function(b,c,d){a.reset(_.sortBy(b,"name"))}})}})}(),Directory.Collections=Directory.Collections||{},function(){"use strict";Directory.Collections.Squads=Backbone.Collection.extend({model:Directory.Models.Squad,load:function(){var a=this;$.ajax({method:"GET",url:"/squads",format:"json",success:function(b,c,d){a.reset(_.sortBy(b,"name"))}})}})}(),Directory.Views=Directory.Views||{},function(){"use strict";Directory.Views.ApplicationLayout=Marionette.LayoutView.extend({template:JST["app/scripts/templates/ApplicationLayout.hbs"],tagName:"div",className:"engineering-directory",events:{},regions:{engineerList:".engineer-list-container",squadList:".squad-list-container",newEngineerForm:".new-engineer-form-container"},initialize:function(){},onRender:function(){console.log("onRender"),this.engineerListView=new Directory.Views.EngineerList({collection:Directory.engineers}),this.newEngineerForm=new Directory.Views.NewEngineerForm({model:new Directory.Models.Engineer,collection:Directory.squads}),this.showChildView("engineerList",this.engineerListView),this.showChildView("newEngineerForm",this.newEngineerForm)}})}(),Directory.Views=Directory.Views||{},function(){"use strict";Directory.Views.EngineerList=Marionette.CompositeView.extend({template:JST["app/scripts/templates/EngineerList.hbs"],getChildView:function(){return Directory.Views.EngineerView},childViewContainer:".engineers",tagName:"div",className:"engineer-list",events:{"click button[data-action=refresh]":"refresh"},refresh:function(){this.collection.load()}})}(),Directory.Views=Directory.Views||{},function(){"use strict";Directory.Views.EngineerView=Marionette.ItemView.extend({template:JST["app/scripts/templates/EngineerView.hbs"],tagName:"div",className:"engineer",events:{}})}(),Directory.Views=Directory.Views||{},function(){"use strict";Directory.Views.NewEngineerForm=Marionette.CompositeView.extend({template:JST["app/scripts/templates/NewEngineerForm.hbs"],getChildView:function(){return Directory.Views.SquadMembershipSelector},childViewContainer:"table.squad-memberships tbody",tagName:"form",className:"new-engineer",events:{submit:"handleSubmit"},childEvents:{"membership-changed":"handleMembershipChanged"},initialize:function(){this.listenTo(Directory.squads,"update",this.render)},handleMembershipChanged:function(a,b){var c=this.model.get("squads");switch(c=c.filter(function(a){return a.get("name")!==b.name}),b.membership){case"none":break;case"current":c.push(_.extend(b.model.toJSON(),{current:!0}));break;case"former":c.push(_.extend(b.model.toJSON(),{current:!1}))}this.model.set("squads",new Directory.Collections.Squads(c))},handleSubmit:function(a){a.preventDefault();var b=this;return this.model.set("name",this.$el.find("input[name=name]").val()),this.model.set("username",this.$el.find("input[name=username]").val()),this.model.isValid()?(console.log(this.model.toJSON()),void $.ajax({method:"POST",url:"/engineers",data:JSON.stringify(this.model.toJSON()),dataType:"json",contentType:"application/json; charset=UTF-8",success:function(){b.hideValidationError(),Directory.engineers.load()}})):this.showValidationError()},showValidationError:function(){this.$el.find(".validation-error").text(this.model.validationError).show()},hideValidationError:function(){this.$el.find(".validation-error").text("").hide()}})}(),Directory.Views=Directory.Views||{},function(){"use strict";Directory.Views.SquadMembershipSelector=Marionette.ItemView.extend({template:JST["app/scripts/templates/SquadMembershipSelector.hbs"],tagName:"tr",className:"squad-membership-selector",events:{"change input":"handleCheckboxChanges"},handleCheckboxChanges:function(a){var b=$(a.target),c=b.closest("tr").find("input[type=checkbox]");c.not(b).attr("checked",null),this.membership={name:this.model.get("name"),model:this.model,membership:c.filter(":checked").data("membership")||"none"},this.trigger("membership-changed",this.membership)}})}();